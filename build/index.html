<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Multipaint</title><script src="https://unpkg.com/react@18/umd/react.production.min.js"></script><script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script><style>body{background-color:#121212;color:#fff;font-family:Arial,sans-serif;margin:0;padding:0;height:100vh;overflow:hidden;display:flex;align-items:center;justify-content:center;margin:0;padding:0;overflow:hidden;position:relative}#canvas{display:none}#content{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;overflow:hidden}#settings{display:flex;flex-direction:column;align-items:center}button,input,label{color:#fff}input{background-color:#555;padding:8px;margin-bottom:10px;color:#fff;border:none;border-radius:3px}input[type=color]{padding:8px;margin-bottom:10px;border:none;border-radius:3px}button{background-color:#4caf50;border:none;padding:10px 15px;border-radius:5px;cursor:pointer}button:hover{background-color:#45a049}#messages{height:30vh;overflow-y:auto;margin:10px 0 0 10px;padding:0;list-style-type:none;color:#fff;position:fixed}#form{position:fixed;bottom:0;left:0;right:0;background-color:#333;padding:10px;border-radius:5px;display:flex;align-items:center;justify-content:space-between}#m{flex:1;padding:8px;margin-right:10px;background-color:#555;color:#fff;border:none;border-radius:3px}#messages li span.system{color:#fff}#messages li span.default-username{color:#fff}</style><script defer="defer" src="/static/js/main.4be2b3dc.js"></script><link href="/static/css/main.e6c13ad2.css" rel="stylesheet"></head><body><div id="root"></div><canvas id="canvas" width="3000" height="3000"></canvas><div id="landing" style="text-align:center;margin-top:50px"><a href="https://www.buymeacoffee.com/multipaint"><button id="donateButton" style="position:fixed;top:10px;right:10px;background-color:#6772e5;color:#fff;font-size:1em;padding:8px 15px;border:none;border-radius:5px;cursor:pointer;display:flex">Donate</button></a> <a href="/privacy"><button id="privacyButton" style="position:fixed;top:50px;right:10px;background-color:#6772e5;color:#fff;font-size:1em;padding:8px 15px;border:none;border-radius:5px;cursor:pointer;display:flex">Privacy Policy</button></a><h1 style="font-size:2.5em;margin-bottom:10px;display:flex;justify-content:center"><form id="form" action=""><div id="card-element"></div><div id="card-errors" role="alert"></div></form><span style="color:red">M</span> <span style="color:#ff7f00">u</span> <span style="color:#ff0">l</span> <span style="color:#0f0">t</span> <span style="color:#00f">i</span> <span style="color:indigo">p</span> <span style="color:#9400d3">a</span> <span style="color:red">i</span> <span style="color:#ff7f00">n</span> <span style="color:#ff0">t</span></h1><p style="color:#ccc;font-size:1.2em;margin-bottom:20px">Create or Join a Room</p><label for="roomCode" style="color:#fff;font-size:1.2em">Enter Room Code:</label><div style="display:flex;align-items:center;justify-content:center;flex-direction:column;margin-bottom:20px"><input id="roomCode" onkeyup="handleKeyUp(event)" style="padding:8px;font-size:1em;border:1px solid #555;border-radius:3px;margin-bottom:10px;display:flex"/> <button onclick="joinRoom()" style="background-color:#4caf50;color:#fff;font-size:1em;padding:8px 15px;border:none;border-radius:5px;cursor:pointer;display:flex">Join Room</button> <button onclick="generateAndJoinRoom()" style="background-color:#4caf50;color:#fff;font-size:1em;padding:8px 15px;border:none;border-radius:5px;cursor:pointer;display:flex;margin-top:10px">Generate Random Room</button> <button onclick="joinRandomRoom()" style="background-color:#4caf50;color:#fff;font-size:1em;padding:8px 15px;border:none;border-radius:5px;cursor:pointer;display:flex;margin-top:10px">Join Random Room</button></div></div><div id="content"><div id="settings" style="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)"><label for="username">Username:</label> <input id="username" autocomplete="off"/> <label for="color">Color:</label> <input id="color" type="color" value="#ffffff"/> <button id="updateSettings" onclick="updateSettings()">Join Room</button></div><div id="activeUsersCount" style="position:fixed;top:10px;left:10px;color:#fff"></div><ul id="messages" style="flex:1;display:flex;flex-direction:column;align-items:flex-start;margin-left:10px;left:0;top:10%"></ul><div id="clearCanvasContainer" style="position:fixed;top:10px;left:50%;transform:translateX(-50%)"><button id="clearCanvasButton" onclick="clearCanvas()">Clear Canvas</button></div><button id="saveCanvasButton" onclick="saveCanvasImage()" style="position:fixed;top:10px;right:10px;background-color:#4caf50;color:#fff;font-size:1em;padding:8px 15px;border:none;border-radius:5px;cursor:pointer;display:flex">Save Image</button> <button style="position:fixed;top:50px;right:10px;background-color:#4caf50;color:#fff;font-size:1em;padding:8px 15px;border:none;border-radius:5px;cursor:pointer;display:flex" onclick='window.location.href="/"'>Back to Menu</button><form id="form" action=""><input id="m" autocomplete="off"/><button>Send</button></form></div><script src="https://code.jquery.com/jquery-3.6.4.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script><script>const socket=io(),room=window.location.pathname.slice(1);let username="",color="",activeRooms={},activeRoomsVar=[];function joinRoom(){const t=$("#roomCode").val().trim();t&&(window.location.href=`/${t}`)}function handleKeyUp(t){"Enter"===t.key&&joinRoom()}const roomCodeInUrl=window.location.pathname.slice(1);roomCodeInUrl?($("#content").show(),$("#landing").hide(),document.title=roomCodeInUrl):($("#landing").show(),$("#content").hide(),$("#canvas").hide());const enableMessageInput=()=>{$("#m").prop("disabled",!1),$("form button").prop("disabled",!1)},restoreCanvas=()=>{socket.emit("restoreCanvas",{ctx:ctx})},updateSettings=()=>{username=$("#username").val()||"Guest",color=$("#color").val()||"#000000",socket.emit("join",{room:room,username:username,color:color}),restoreCanvas(),$("#settings").hide(),$("#canvas").show(),enableMessageInput()},sendMessage=(t,o)=>{socket.emit(t,{room:room,username:username,color:color,...o}),$("#m").val("")};let canvas,ctx,drawing,lastX,lastY,touchStartX,touchStartY;function startDrawing(t){const o=canvas.getBoundingClientRect();[lastX,lastY]=[t.clientX-o.left,t.clientY-o.top],ctx.beginPath(),ctx.moveTo(lastX,lastY),drawing=!0,sendMessage("drawingStart",{startX:lastX,startY:lastY})}function draw(t){if(!drawing)return;t.preventDefault();const o=canvas.getBoundingClientRect(),[e,n]=[t.clientX-o.left,t.clientY-o.top];ctx.strokeStyle=color,ctx.lineWidth=2,ctx.lineTo(e,n),ctx.stroke(),[lastX,lastY]=[e,n],sendMessage("drawing",{x:e,y:n,color:color})}function stopDrawing(){drawing=!1,sendMessage("drawingEnd",{})}function handleTouchStart(t){t.preventDefault();const o=t.touches[0],e=canvas.getBoundingClientRect();[touchStartX,touchStartY]=[o.clientX-e.left,o.clientY-e.top],ctx.beginPath(),ctx.moveTo(touchStartX,touchStartY),sendMessage("drawingStart",{startX:touchStartX,startY:touchStartY})}function handleTouchMove(t){t.preventDefault();const o=t.touches[0],e=canvas.getBoundingClientRect(),[n,a]=[o.clientX-e.left,o.clientY-e.top];ctx.strokeStyle=color,ctx.lineWidth=2,ctx.lineTo(n,a),ctx.stroke(),[touchStartX,touchStartY]=[n,a],sendMessage("drawing",{x:n,y:a,color:color})}function handleTouchEnd(t){t.preventDefault(),drawing=!1,sendMessage("drawingEnd",{})}function clearCanvas(){ctx.clearRect(0,0,canvas.width,canvas.height),sendMessage("clearCanvas",{})}function appendMessage(t){const o=$("<li>").html(t),e=$("#messages");e.append(o),e.scrollTop(e.prop("scrollHeight"))}function getActiveRooms(){const t=Object.keys(activeRooms).filter((t=>activeRooms[t]>0));return t}function joinRandomRoom(){const t=activeRooms;if(t.length>0){const o=t[Math.floor(Math.random()*t.length)];console.log("Random Room:",o),window.location.href=`/${o}`,io.to(data.room).emit("activeUsersCount",{room:data.room,count:activeRooms[data.room]})}else alert("No active rooms available. Create or join a room manually.")}$("form").submit((function(){return sendMessage("message",{message:$("#m").val().trim()}),!1})),$("#username").on("keyup",(function(t){"Enter"===t.key&&updateSettings()})),socket.on("message",(function(t){appendMessage(`<span style="color: ${t.color}">${t.username}:</span> ${t.message}`)})),$(document).ready((function(){canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),drawing=!1,lastX=0,lastY=0,canvas.addEventListener("mousedown",startDrawing),canvas.addEventListener("mousemove",draw),canvas.addEventListener("mouseup",stopDrawing),canvas.addEventListener("mouseout",stopDrawing),canvas.addEventListener("touchstart",handleTouchStart),canvas.addEventListener("touchmove",handleTouchMove),canvas.addEventListener("touchend",handleTouchEnd)})),socket.on("drawingStart",(function(t){[lastX,lastY]=[t.startX,t.startY],ctx.beginPath(),ctx.moveTo(lastX,lastY)})),socket.on("drawing",(function(t){const[o,e]=[t.x,t.y];ctx.strokeStyle=t.color,ctx.lineWidth=2,ctx.lineTo(o,e),ctx.stroke(),[lastX,lastY]=[o,e]})),socket.on("drawingEnd",(function(){drawing=!1})),socket.on("clearCanvas",(function(){ctx.clearRect(0,0,canvas.width,canvas.height)})),socket.on("userJoin",(function(t){activeRooms[t.room]=(activeRooms[t.room]||0)+1,io.to(t.room).emit("activeUsersCount",{room:t.room,count:activeRooms[t.room]})})),socket.on("userLeave",(function(t){activeRooms[t.room]>0&&(activeRooms[t.room]--,io.to(t.room).emit("activeUsersCount",{room:t.room,count:activeRooms[t.room]}))})),socket.on("activeRooms",(function(t){activeRooms=t.activeRooms,activeRoomsVar=activeRooms})),socket.on("connection",(function(t){t.on("activeUsersCount",(function(o){io.to(t.id).emit("activeUsersCount",{room:o.room,count:activeRooms[o.room]})}))}));const saveCanvasImage=()=>{const t=document.getElementById("canvas").toDataURL(),o=document.createElement("a");o.href=t,o.download="image.png",o.click()};function generateAndJoinRoom(){const t=generateRandomRoomCode();window.location.href=`/${t}`}function generateRandomRoomCode(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let o="";for(let e=0;e<6;e++){const e=Math.floor(62*Math.random());o+=t.charAt(e)}return o}function updateActiveUsersCount(t){$("#activeUsersCount").text(`Active Users: ${t}`)}socket.on("activeUsersCount",(function(t){updateActiveUsersCount(t.count)}))</script></body></html>